<!DOCTYPE html>
<html>
  <head>
    <title>Проект "Комменты"</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <ul class="comments" id="comments">
        <!-- <li class="comment">
          <div class="comment-header">
            <div>Глеб Фокин</div>
            <div>12.02.22 12:18</div>
          </div>
          <div class="comment-body">
            <div class="comment-text">
              Это будет первый комментарий на этой странице
            </div>
          </div>
          <div class="comment-footer">
            <div class="likes">
              <span class="likes-counter">5</span>
              <button class="like-button"></button>
            </div>
          </div>
        </li>
        <li class="comment">
          <div class="comment-header">
            <div>Варвара Н.</div>
            <div>13.02.22 19:22</div>
          </div>
          <div class="comment-body">
            <div class="comment-text">
              Мне нравится как оформлена эта страница! ❤
            </div>
          </div>
          <div class="comment-footer">
            <div class="likes">
              <span class="likes-counter">75</span>
              <button class="like-button"></button>
            </div>
          </div>
        </li> -->
      </ul>
      <div class="add-form">
        <input
          type="text"
          class="add-form-name"
          placeholder="Введите ваше имя"
          id="name-input"
        />
        <textarea
          type="textarea"
          class="add-form-text"
          placeholder="Введите ваш коментарий"
          rows="4"
          id="comment-area"
        ></textarea>
        <div class="add-form-row">
          <button class="add-form-button" id="add-form-button">Написать</button>
        </div>
      </div>
    </div>

    <!-- добавление нового коммента -->
    <script>
      const butAddComment = document.querySelector(".add-form-button");
      const listOfComments = document.querySelector(".comments");
      const nameInputElement = document.querySelector("#name-input");
      const commentAreaElement = document.querySelector("#comment-area");

      const allComments = [
        {
          name: "Глеб Фокин",
          date: "12.02.22 12:18",
          textOfComment: "Это будет первый комментарий на этой странице",
          likes: 5,
        },
        {
          name: "Варвара Н.",
          date: "13.02.22 19:22",
          textOfComment: "Мне нравится как оформлена эта страница! ❤",
          likes: 72,
        },
      ];

      const renderComments = () => {
        const commentsHtml = allComments
          .map((comment) => {
            return `<li class="comment">
          <div class="comment-header">
            <div>${comment.name}</div>
            <div>${comment.date}</div>
          </div>
          <div class="comment-body">
            <div class="comment-text">
              ${comment.textOfComment}
            </div>
          </div>
          <div class="comment-footer">
            <div class="likes">
              <span class="likes-counter">${comment.likes}</span>
              <button class="like-button"></button>
            </div>
          </div>
        </li>`;
          })
          .join("");

        listOfComments.innerHTML = commentsHtml;
      };

      renderComments();

      const currentDate = new Date();
      let day = currentDate.getDate();
      if (day < 10) {
        day = "0" + day;
      }
      const months = [
        "01",
        "02",
        "03",
        "04",
        "05",
        "06",
        "07",
        "08",
        "09",
        "10",
        "11",
        "12",
      ];
      let month = months[currentDate.getMonth()];
      let year = currentDate.getFullYear() % 100;
      if (year < 10) year = "0" + year;

      let hour = currentDate.getHours();
      if (hour < 10) {
        hour = "0" + hour;
      }
      let minute = currentDate.getMinutes();
      if (minute < 10) {
        minute = "0" + minute;
      }
      const newDate =
        day + "." + month + "." + year + " " + hour + ":" + minute;

      // butAddComment.setAttribute("disabled", true);
      butAddComment.addEventListener("click", () => {
        if (nameInputElement.value === "" || commentAreaElement.value === "") {
          // butAddComment.setAttribute("disabled", true);
          alert("Требуется заполнить все поля!");
          return;
        }

        allComments.push({
          name: nameInputElement.value,
          date: newDate,
          textOfComment: commentAreaElement.value,
          likes: 0,
        });

        renderComments();

        let likeButton = document.querySelectorAll(".like-button");
        let likesCounter = document.querySelectorAll(".likes-counter");
        for (let i = 0; i < likeButton.length; i++) {
          for (let i = 0; i < likesCounter.length; i++) {
            likeButton[i].onclick = function () {
              if (likeButton[i].classList.contains("-active-like")) {
                likesCounter[i].textContent--;
              } else {
                likesCounter[i].textContent++;
              }
              likeButton[i].classList.toggle("-active-like");
            };
          }
        }
      });
    </script>

    <!-- добавление лайков -->

    <script>
      let likeButton = document.querySelectorAll(".like-button");
      let likesCounter = document.querySelectorAll(".likes-counter");
      for (let i = 0; i < likeButton.length; i++) {
        for (let i = 0; i < likesCounter.length; i++) {
          likeButton[i].onclick = function () {
            if (likeButton[i].classList.contains("-active-like")) {
              likesCounter[i].textContent--;
            } else {
              likesCounter[i].textContent++;
            }
            likeButton[i].classList.toggle("-active-like");
          };
        }
      }
    </script>
  </body>
</html>
